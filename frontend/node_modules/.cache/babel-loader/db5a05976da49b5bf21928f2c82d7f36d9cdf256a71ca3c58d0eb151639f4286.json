{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Dali_bnslh\\\\Desktop\\\\Final plat\\\\frontend\\\\src\\\\pages\\\\CourseContent.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { useAuth } from '../context/AuthContext';\nimport { courseService } from '../services/courseService';\nimport ReactPlayer from 'react-player';\nimport { Play, Pause, SkipBack, SkipForward, Volume2, Maximize, BookOpen, CheckCircle, ChevronRight, Clock, FileText, Award } from 'lucide-react';\nimport LoadingSpinner from '../components/LoadingSpinner';\nimport toast from 'react-hot-toast';\nimport './CourseContent.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CourseContent = () => {\n  _s();\n  var _currentModuleData$vi2;\n  const {\n    id\n  } = useParams();\n  const {\n    user\n  } = useAuth();\n  const navigate = useNavigate();\n  const [course, setCourse] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [currentModule, setCurrentModule] = useState(0);\n  const [currentVideo, setCurrentVideo] = useState(0);\n  const [videoProgress, setVideoProgress] = useState(0);\n  const [courseProgress, setCourseProgress] = useState(0);\n  const [completedVideos, setCompletedVideos] = useState(new Set());\n  const [playing, setPlaying] = useState(false);\n  const [sidebarOpen, setSidebarOpen] = useState(true);\n  useEffect(() => {\n    loadCourseContent();\n  }, [id]);\n  useEffect(() => {\n    if (course) {\n      calculateProgress();\n    }\n  }, [completedVideos, course]);\n  const loadCourseContent = async () => {\n    try {\n      var _user$coursInscrits;\n      const response = await courseService.getCourseContent(id);\n      setCourse(response.course);\n\n      // Charger la progression sauvegardée\n      const userCourse = user === null || user === void 0 ? void 0 : (_user$coursInscrits = user.coursInscrits) === null || _user$coursInscrits === void 0 ? void 0 : _user$coursInscrits.find(c => c.coursId === id);\n      if (userCourse) {\n        setCourseProgress(userCourse.progression || 0);\n      }\n    } catch (error) {\n      var _error$response;\n      console.error('Erreur chargement contenu:', error);\n      if (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 403) {\n        toast.error('Vous devez être inscrit à ce cours pour accéder au contenu');\n        navigate(`/courses/${id}`);\n      } else {\n        toast.error('Erreur lors du chargement du contenu');\n        navigate('/courses');\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n  const calculateProgress = () => {\n    if (!(course !== null && course !== void 0 && course.modules)) return;\n    const totalVideos = course.modules.reduce((acc, module) => {\n      var _module$videos;\n      return acc + (((_module$videos = module.videos) === null || _module$videos === void 0 ? void 0 : _module$videos.length) || 0);\n    }, 0);\n    if (totalVideos === 0) return;\n    const progress = Math.round(completedVideos.size / totalVideos * 100);\n    setCourseProgress(progress);\n  };\n  const updateProgress = async progress => {\n    try {\n      await courseService.updateProgress(id, progress);\n    } catch (error) {\n      console.error('Erreur mise à jour progression:', error);\n    }\n  };\n  const handleVideoProgress = progress => {\n    setVideoProgress(progress.played * 100);\n\n    // Marquer comme terminé si plus de 90% regardé\n    if (progress.played > 0.9) {\n      const videoKey = `${currentModule}-${currentVideo}`;\n      if (!completedVideos.has(videoKey)) {\n        setCompletedVideos(prev => new Set([...prev, videoKey]));\n      }\n    }\n  };\n  const handleVideoEnd = () => {\n    const videoKey = `${currentModule}-${currentVideo}`;\n    setCompletedVideos(prev => new Set([...prev, videoKey]));\n\n    // Passer à la vidéo suivante automatiquement\n    goToNextVideo();\n  };\n  const goToVideo = (moduleIndex, videoIndex) => {\n    setCurrentModule(moduleIndex);\n    setCurrentVideo(videoIndex);\n    setVideoProgress(0);\n    setPlaying(true);\n  };\n  const goToNextVideo = () => {\n    var _currentModuleData$vi;\n    const currentModuleData = course.modules[currentModule];\n\n    // Vérifier s'il y a une vidéo suivante dans le module actuel\n    if (currentVideo < (((_currentModuleData$vi = currentModuleData.videos) === null || _currentModuleData$vi === void 0 ? void 0 : _currentModuleData$vi.length) || 0) - 1) {\n      setCurrentVideo(currentVideo + 1);\n    } else {\n      // Passer au module suivant\n      if (currentModule < course.modules.length - 1) {\n        setCurrentModule(currentModule + 1);\n        setCurrentVideo(0);\n      } else {\n        // Cours terminé\n        toast.success('Félicitations ! Vous avez terminé le cours !');\n        setPlaying(false);\n      }\n    }\n    setVideoProgress(0);\n  };\n  const goToPreviousVideo = () => {\n    if (currentVideo > 0) {\n      setCurrentVideo(currentVideo - 1);\n    } else if (currentModule > 0) {\n      var _prevModule$videos;\n      const prevModule = course.modules[currentModule - 1];\n      setCurrentModule(currentModule - 1);\n      setCurrentVideo((((_prevModule$videos = prevModule.videos) === null || _prevModule$videos === void 0 ? void 0 : _prevModule$videos.length) || 1) - 1);\n    }\n    setVideoProgress(0);\n  };\n  const isVideoCompleted = (moduleIndex, videoIndex) => {\n    return completedVideos.has(`${moduleIndex}-${videoIndex}`);\n  };\n  const formatDuration = seconds => {\n    const minutes = Math.floor(seconds / 60);\n    const remainingSeconds = Math.floor(seconds % 60);\n    return `${minutes}:${remainingSeconds.toString().padStart(2, '0')}`;\n  };\n\n  // Sauvegarder la progression périodiquement\n  useEffect(() => {\n    const interval = setInterval(() => {\n      if (courseProgress > 0) {\n        updateProgress(courseProgress);\n      }\n    }, 30000); // Toutes les 30 secondes\n\n    return () => clearInterval(interval);\n  }, [courseProgress]);\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(LoadingSpinner, {\n      text: \"Chargement du contenu...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 12\n    }, this);\n  }\n  if (!course) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"course-error\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Contenu non disponible\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Le contenu de ce cours n'est pas accessible.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 7\n    }, this);\n  }\n  const currentModuleData = course.modules[currentModule];\n  const currentVideoData = currentModuleData === null || currentModuleData === void 0 ? void 0 : (_currentModuleData$vi2 = currentModuleData.videos) === null || _currentModuleData$vi2 === void 0 ? void 0 : _currentModuleData$vi2[currentVideo];\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"course-content-page\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"video-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"video-container\",\n        children: currentVideoData ? /*#__PURE__*/_jsxDEV(ReactPlayer, {\n          url: currentVideoData.url,\n          width: \"100%\",\n          height: \"100%\",\n          playing: playing,\n          onProgress: handleVideoProgress,\n          onEnded: handleVideoEnd,\n          controls: true,\n          config: {\n            file: {\n              attributes: {\n                controlsList: 'nodownload'\n              }\n            }\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"video-placeholder\",\n          children: [/*#__PURE__*/_jsxDEV(Play, {\n            size: 64\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 213,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"S\\xE9lectionnez une vid\\xE9o pour commencer\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 214,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"video-controls\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"video-info\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: (currentVideoData === null || currentVideoData === void 0 ? void 0 : currentVideoData.titre) || 'Aucune vidéo sélectionnée'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 222,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"video-meta\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: [\"Module \", currentModule + 1, \": \", currentModuleData === null || currentModuleData === void 0 ? void 0 : currentModuleData.titre]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 224,\n              columnNumber: 15\n            }, this), (currentVideoData === null || currentVideoData === void 0 ? void 0 : currentVideoData.duree) && /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [\"\\u2022 \", formatDuration(currentVideoData.duree)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 226,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 223,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 221,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"video-actions\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: goToPreviousVideo,\n            disabled: currentModule === 0 && currentVideo === 0,\n            className: \"btn btn-outline\",\n            children: [/*#__PURE__*/_jsxDEV(SkipBack, {\n              size: 16\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 237,\n              columnNumber: 15\n            }, this), \"Pr\\xE9c\\xE9dent\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 232,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setPlaying(!playing),\n            className: \"btn btn-primary\",\n            children: [playing ? /*#__PURE__*/_jsxDEV(Pause, {\n              size: 16\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 245,\n              columnNumber: 26\n            }, this) : /*#__PURE__*/_jsxDEV(Play, {\n              size: 16\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 245,\n              columnNumber: 48\n            }, this), playing ? 'Pause' : 'Lecture']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 241,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: goToNextVideo,\n            className: \"btn btn-outline\",\n            children: [\"Suivant\", /*#__PURE__*/_jsxDEV(SkipForward, {\n              size: 16\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 254,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 249,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"video-progress-bar\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"progress-fill\",\n          style: {\n            width: `${videoProgress}%`\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 261,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `course-sidebar ${sidebarOpen ? 'open' : 'closed'}`,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"sidebar-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"course-title\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: course.titre\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 272,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"course-progress-info\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: [courseProgress, \"% termin\\xE9\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 274,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"progress-bar\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"progress-fill\",\n                style: {\n                  width: `${courseProgress}%`\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 276,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 275,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 273,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 271,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"sidebar-toggle\",\n          onClick: () => setSidebarOpen(!sidebarOpen),\n          children: /*#__PURE__*/_jsxDEV(ChevronRight, {\n            className: sidebarOpen ? 'rotate' : ''\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 288,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 284,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"sidebar-content\",\n        children: [course.modules.map((module, moduleIndex) => {\n          var _module$videos2;\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"module-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"module-header\",\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"module-number\",\n                  children: [moduleIndex + 1, \".\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 297,\n                  columnNumber: 19\n                }, this), module.titre]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 296,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"module-count\",\n                children: [((_module$videos2 = module.videos) === null || _module$videos2 === void 0 ? void 0 : _module$videos2.length) || 0, \" vid\\xE9os\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 300,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 295,\n              columnNumber: 15\n            }, this), module.videos && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"module-videos\",\n              children: module.videos.map((video, videoIndex) => /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => goToVideo(moduleIndex, videoIndex),\n                className: `video-item ${currentModule === moduleIndex && currentVideo === videoIndex ? 'active' : ''}`,\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"video-icon\",\n                  children: isVideoCompleted(moduleIndex, videoIndex) ? /*#__PURE__*/_jsxDEV(CheckCircle, {\n                    size: 16,\n                    className: \"completed\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 319,\n                    columnNumber: 27\n                  }, this) : /*#__PURE__*/_jsxDEV(Play, {\n                    size: 16\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 321,\n                    columnNumber: 27\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 317,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"video-details\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"video-title\",\n                    children: video.titre\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 326,\n                    columnNumber: 25\n                  }, this), video.duree && /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"video-duration\",\n                    children: formatDuration(video.duree)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 328,\n                    columnNumber: 27\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 325,\n                  columnNumber: 23\n                }, this)]\n              }, videoIndex, true, {\n                fileName: _jsxFileName,\n                lineNumber: 308,\n                columnNumber: 21\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 306,\n              columnNumber: 17\n            }, this), module.documents && module.documents.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"module-documents\",\n              children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n                children: \"Documents\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 340,\n                columnNumber: 19\n              }, this), module.documents.map((doc, docIndex) => /*#__PURE__*/_jsxDEV(\"a\", {\n                href: doc.url,\n                target: \"_blank\",\n                rel: \"noopener noreferrer\",\n                className: \"document-item\",\n                children: [/*#__PURE__*/_jsxDEV(FileText, {\n                  size: 16\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 349,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: doc.titre\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 350,\n                  columnNumber: 23\n                }, this)]\n              }, docIndex, true, {\n                fileName: _jsxFileName,\n                lineNumber: 342,\n                columnNumber: 21\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 339,\n              columnNumber: 17\n            }, this)]\n          }, moduleIndex, true, {\n            fileName: _jsxFileName,\n            lineNumber: 294,\n            columnNumber: 13\n          }, this);\n        }), courseProgress === 100 && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"course-completion\",\n          children: [/*#__PURE__*/_jsxDEV(Award, {\n            size: 32\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 361,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n            children: \"Cours termin\\xE9 !\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 362,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"F\\xE9licitations pour avoir termin\\xE9 ce cours\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 363,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn btn-primary\",\n            children: \"Obtenir le certificat\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 364,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 360,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 292,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 269,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 190,\n    columnNumber: 5\n  }, this);\n};\n_s(CourseContent, \"3mg0LO933jhHeUvGdiUHfAV9dQE=\", false, function () {\n  return [useParams, useAuth, useNavigate];\n});\n_c = CourseContent;\nexport default CourseContent;\nvar _c;\n$RefreshReg$(_c, \"CourseContent\");","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","useAuth","courseService","ReactPlayer","Play","Pause","SkipBack","SkipForward","Volume2","Maximize","BookOpen","CheckCircle","ChevronRight","Clock","FileText","Award","LoadingSpinner","toast","jsxDEV","_jsxDEV","CourseContent","_s","_currentModuleData$vi2","id","user","navigate","course","setCourse","loading","setLoading","currentModule","setCurrentModule","currentVideo","setCurrentVideo","videoProgress","setVideoProgress","courseProgress","setCourseProgress","completedVideos","setCompletedVideos","Set","playing","setPlaying","sidebarOpen","setSidebarOpen","loadCourseContent","calculateProgress","_user$coursInscrits","response","getCourseContent","userCourse","coursInscrits","find","c","coursId","progression","error","_error$response","console","status","modules","totalVideos","reduce","acc","module","_module$videos","videos","length","progress","Math","round","size","updateProgress","handleVideoProgress","played","videoKey","has","prev","handleVideoEnd","goToNextVideo","goToVideo","moduleIndex","videoIndex","_currentModuleData$vi","currentModuleData","success","goToPreviousVideo","_prevModule$videos","prevModule","isVideoCompleted","formatDuration","seconds","minutes","floor","remainingSeconds","toString","padStart","interval","setInterval","clearInterval","text","fileName","_jsxFileName","lineNumber","columnNumber","className","children","currentVideoData","url","width","height","onProgress","onEnded","controls","config","file","attributes","controlsList","titre","duree","onClick","disabled","style","map","_module$videos2","video","documents","doc","docIndex","href","target","rel","_c","$RefreshReg$"],"sources":["C:/Users/Dali_bnslh/Desktop/Final plat/frontend/src/pages/CourseContent.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport { courseService } from '../services/courseService';\r\nimport ReactPlayer from 'react-player';\r\nimport {\r\n  Play,\r\n  Pause,\r\n  SkipBack,\r\n  SkipForward,\r\n  Volume2,\r\n  Maximize,\r\n  BookOpen,\r\n  CheckCircle,\r\n  ChevronRight,\r\n  Clock,\r\n  FileText,\r\n  Award\r\n} from 'lucide-react';\r\nimport LoadingSpinner from '../components/LoadingSpinner';\r\nimport toast from 'react-hot-toast';\r\nimport './CourseContent.css';\r\n\r\nconst CourseContent = () => {\r\n  const { id } = useParams();\r\n  const { user } = useAuth();\r\n  const navigate = useNavigate();\r\n  \r\n  const [course, setCourse] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [currentModule, setCurrentModule] = useState(0);\r\n  const [currentVideo, setCurrentVideo] = useState(0);\r\n  const [videoProgress, setVideoProgress] = useState(0);\r\n  const [courseProgress, setCourseProgress] = useState(0);\r\n  const [completedVideos, setCompletedVideos] = useState(new Set());\r\n  const [playing, setPlaying] = useState(false);\r\n  const [sidebarOpen, setSidebarOpen] = useState(true);\r\n\r\n  useEffect(() => {\r\n    loadCourseContent();\r\n  }, [id]);\r\n\r\n  useEffect(() => {\r\n    if (course) {\r\n      calculateProgress();\r\n    }\r\n  }, [completedVideos, course]);\r\n\r\n  const loadCourseContent = async () => {\r\n    try {\r\n      const response = await courseService.getCourseContent(id);\r\n      setCourse(response.course);\r\n      \r\n      // Charger la progression sauvegardée\r\n      const userCourse = user?.coursInscrits?.find(c => c.coursId === id);\r\n      if (userCourse) {\r\n        setCourseProgress(userCourse.progression || 0);\r\n      }\r\n    } catch (error) {\r\n      console.error('Erreur chargement contenu:', error);\r\n      if (error.response?.status === 403) {\r\n        toast.error('Vous devez être inscrit à ce cours pour accéder au contenu');\r\n        navigate(`/courses/${id}`);\r\n      } else {\r\n        toast.error('Erreur lors du chargement du contenu');\r\n        navigate('/courses');\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const calculateProgress = () => {\r\n    if (!course?.modules) return;\r\n\r\n    const totalVideos = course.modules.reduce((acc, module) => \r\n      acc + (module.videos?.length || 0), 0\r\n    );\r\n\r\n    if (totalVideos === 0) return;\r\n\r\n    const progress = Math.round((completedVideos.size / totalVideos) * 100);\r\n    setCourseProgress(progress);\r\n  };\r\n\r\n  const updateProgress = async (progress) => {\r\n    try {\r\n      await courseService.updateProgress(id, progress);\r\n    } catch (error) {\r\n      console.error('Erreur mise à jour progression:', error);\r\n    }\r\n  };\r\n\r\n  const handleVideoProgress = (progress) => {\r\n    setVideoProgress(progress.played * 100);\r\n    \r\n    // Marquer comme terminé si plus de 90% regardé\r\n    if (progress.played > 0.9) {\r\n      const videoKey = `${currentModule}-${currentVideo}`;\r\n      if (!completedVideos.has(videoKey)) {\r\n        setCompletedVideos(prev => new Set([...prev, videoKey]));\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleVideoEnd = () => {\r\n    const videoKey = `${currentModule}-${currentVideo}`;\r\n    setCompletedVideos(prev => new Set([...prev, videoKey]));\r\n    \r\n    // Passer à la vidéo suivante automatiquement\r\n    goToNextVideo();\r\n  };\r\n\r\n  const goToVideo = (moduleIndex, videoIndex) => {\r\n    setCurrentModule(moduleIndex);\r\n    setCurrentVideo(videoIndex);\r\n    setVideoProgress(0);\r\n    setPlaying(true);\r\n  };\r\n\r\n  const goToNextVideo = () => {\r\n    const currentModuleData = course.modules[currentModule];\r\n    \r\n    // Vérifier s'il y a une vidéo suivante dans le module actuel\r\n    if (currentVideo < (currentModuleData.videos?.length || 0) - 1) {\r\n      setCurrentVideo(currentVideo + 1);\r\n    } else {\r\n      // Passer au module suivant\r\n      if (currentModule < course.modules.length - 1) {\r\n        setCurrentModule(currentModule + 1);\r\n        setCurrentVideo(0);\r\n      } else {\r\n        // Cours terminé\r\n        toast.success('Félicitations ! Vous avez terminé le cours !');\r\n        setPlaying(false);\r\n      }\r\n    }\r\n    setVideoProgress(0);\r\n  };\r\n\r\n  const goToPreviousVideo = () => {\r\n    if (currentVideo > 0) {\r\n      setCurrentVideo(currentVideo - 1);\r\n    } else if (currentModule > 0) {\r\n      const prevModule = course.modules[currentModule - 1];\r\n      setCurrentModule(currentModule - 1);\r\n      setCurrentVideo((prevModule.videos?.length || 1) - 1);\r\n    }\r\n    setVideoProgress(0);\r\n  };\r\n\r\n  const isVideoCompleted = (moduleIndex, videoIndex) => {\r\n    return completedVideos.has(`${moduleIndex}-${videoIndex}`);\r\n  };\r\n\r\n  const formatDuration = (seconds) => {\r\n    const minutes = Math.floor(seconds / 60);\r\n    const remainingSeconds = Math.floor(seconds % 60);\r\n    return `${minutes}:${remainingSeconds.toString().padStart(2, '0')}`;\r\n  };\r\n\r\n  // Sauvegarder la progression périodiquement\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      if (courseProgress > 0) {\r\n        updateProgress(courseProgress);\r\n      }\r\n    }, 30000); // Toutes les 30 secondes\r\n\r\n    return () => clearInterval(interval);\r\n  }, [courseProgress]);\r\n\r\n  if (loading) {\r\n    return <LoadingSpinner text=\"Chargement du contenu...\" />;\r\n  }\r\n\r\n  if (!course) {\r\n    return (\r\n      <div className=\"course-error\">\r\n        <h2>Contenu non disponible</h2>\r\n        <p>Le contenu de ce cours n'est pas accessible.</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const currentModuleData = course.modules[currentModule];\r\n  const currentVideoData = currentModuleData?.videos?.[currentVideo];\r\n\r\n  return (\r\n    <div className=\"course-content-page\">\r\n      {/* Video Player */}\r\n      <div className=\"video-section\">\r\n        <div className=\"video-container\">\r\n          {currentVideoData ? (\r\n            <ReactPlayer\r\n              url={currentVideoData.url}\r\n              width=\"100%\"\r\n              height=\"100%\"\r\n              playing={playing}\r\n              onProgress={handleVideoProgress}\r\n              onEnded={handleVideoEnd}\r\n              controls={true}\r\n              config={{\r\n                file: {\r\n                  attributes: {\r\n                    controlsList: 'nodownload'\r\n                  }\r\n                }\r\n              }}\r\n            />\r\n          ) : (\r\n            <div className=\"video-placeholder\">\r\n              <Play size={64} />\r\n              <p>Sélectionnez une vidéo pour commencer</p>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Video Controls */}\r\n        <div className=\"video-controls\">\r\n          <div className=\"video-info\">\r\n            <h2>{currentVideoData?.titre || 'Aucune vidéo sélectionnée'}</h2>\r\n            <div className=\"video-meta\">\r\n              <span>Module {currentModule + 1}: {currentModuleData?.titre}</span>\r\n              {currentVideoData?.duree && (\r\n                <span>• {formatDuration(currentVideoData.duree)}</span>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"video-actions\">\r\n            <button \r\n              onClick={goToPreviousVideo}\r\n              disabled={currentModule === 0 && currentVideo === 0}\r\n              className=\"btn btn-outline\"\r\n            >\r\n              <SkipBack size={16} />\r\n              Précédent\r\n            </button>\r\n            \r\n            <button \r\n              onClick={() => setPlaying(!playing)}\r\n              className=\"btn btn-primary\"\r\n            >\r\n              {playing ? <Pause size={16} /> : <Play size={16} />}\r\n              {playing ? 'Pause' : 'Lecture'}\r\n            </button>\r\n            \r\n            <button \r\n              onClick={goToNextVideo}\r\n              className=\"btn btn-outline\"\r\n            >\r\n              Suivant\r\n              <SkipForward size={16} />\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Progress Bar */}\r\n        <div className=\"video-progress-bar\">\r\n          <div \r\n            className=\"progress-fill\"\r\n            style={{ width: `${videoProgress}%` }}\r\n          ></div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Course Sidebar */}\r\n      <div className={`course-sidebar ${sidebarOpen ? 'open' : 'closed'}`}>\r\n        <div className=\"sidebar-header\">\r\n          <div className=\"course-title\">\r\n            <h3>{course.titre}</h3>\r\n            <div className=\"course-progress-info\">\r\n              <span>{courseProgress}% terminé</span>\r\n              <div className=\"progress-bar\">\r\n                <div \r\n                  className=\"progress-fill\"\r\n                  style={{ width: `${courseProgress}%` }}\r\n                ></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          \r\n          <button \r\n            className=\"sidebar-toggle\"\r\n            onClick={() => setSidebarOpen(!sidebarOpen)}\r\n          >\r\n            <ChevronRight className={sidebarOpen ? 'rotate' : ''} />\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"sidebar-content\">\r\n          {course.modules.map((module, moduleIndex) => (\r\n            <div key={moduleIndex} className=\"module-section\">\r\n              <div className=\"module-header\">\r\n                <h4>\r\n                  <span className=\"module-number\">{moduleIndex + 1}.</span>\r\n                  {module.titre}\r\n                </h4>\r\n                <span className=\"module-count\">\r\n                  {module.videos?.length || 0} vidéos\r\n                </span>\r\n              </div>\r\n\r\n              {module.videos && (\r\n                <div className=\"module-videos\">\r\n                  {module.videos.map((video, videoIndex) => (\r\n                    <button\r\n                      key={videoIndex}\r\n                      onClick={() => goToVideo(moduleIndex, videoIndex)}\r\n                      className={`video-item ${\r\n                        currentModule === moduleIndex && currentVideo === videoIndex \r\n                          ? 'active' \r\n                          : ''\r\n                      }`}\r\n                    >\r\n                      <div className=\"video-icon\">\r\n                        {isVideoCompleted(moduleIndex, videoIndex) ? (\r\n                          <CheckCircle size={16} className=\"completed\" />\r\n                        ) : (\r\n                          <Play size={16} />\r\n                        )}\r\n                      </div>\r\n                      \r\n                      <div className=\"video-details\">\r\n                        <span className=\"video-title\">{video.titre}</span>\r\n                        {video.duree && (\r\n                          <span className=\"video-duration\">\r\n                            {formatDuration(video.duree)}\r\n                          </span>\r\n                        )}\r\n                      </div>\r\n                    </button>\r\n                  ))}\r\n                </div>\r\n              )}\r\n\r\n              {module.documents && module.documents.length > 0 && (\r\n                <div className=\"module-documents\">\r\n                  <h5>Documents</h5>\r\n                  {module.documents.map((doc, docIndex) => (\r\n                    <a\r\n                      key={docIndex}\r\n                      href={doc.url}\r\n                      target=\"_blank\"\r\n                      rel=\"noopener noreferrer\"\r\n                      className=\"document-item\"\r\n                    >\r\n                      <FileText size={16} />\r\n                      <span>{doc.titre}</span>\r\n                    </a>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </div>\r\n          ))}\r\n\r\n          {/* Course Completion */}\r\n          {courseProgress === 100 && (\r\n            <div className=\"course-completion\">\r\n              <Award size={32} />\r\n              <h4>Cours terminé !</h4>\r\n              <p>Félicitations pour avoir terminé ce cours</p>\r\n              <button className=\"btn btn-primary\">\r\n                Obtenir le certificat\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CourseContent;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}